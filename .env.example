# Database
DATABASE_URL=postgresql://logtide:password@localhost:5432/logtide
DB_NAME=logtide
DB_USER=logtide
DB_PASSWORD=your_secure_password

# Redis
REDIS_PASSWORD=your_secure_redis_password
REDIS_URL=redis://:your_secure_redis_password@localhost:6379

# API
API_KEY_SECRET=your_32_char_secret_key_here
PORT=8080
HOST=0.0.0.0

# Reverse Proxy / Load Balancer
# Set to true when running behind Traefik, nginx, or other reverse proxy
# This enables proper client IP detection for rate limiting and logging
TRUST_PROXY=false

# Port for Traefik to listen on (default: 80)
# Only used when deploying with docker-compose.yml (Traefik setup)
LOGTIDE_PORT=80

# SMTP (configure for email alerts)
SMTP_HOST=smtp.example.com
SMTP_PORT=587
SMTP_USER=your_email@example.com
SMTP_PASS=your_smtp_password
SMTP_FROM=noreply@logtide.local

# Rate Limiting
RATE_LIMIT_MAX=1000
RATE_LIMIT_WINDOW=60000

# Environment
NODE_ENV=development

# Internal Logging (Self-Monitoring)
# Enable/disable internal logging (logs LogTide's own requests/errors)
INTERNAL_LOGGING_ENABLED=true

# API key for internal logging project (auto-generated on first run if not set)
# After first run, copy the generated key from console output and set it here
# INTERNAL_API_KEY=lp_your_generated_api_key_here

# API URL for internal logging (defaults to API_URL if not set)
# INTERNAL_LOGGING_API_URL=http://localhost:8080

# Service name (distinguishes backend from worker in logs)
# Backend: logtide-backend (default)
# Worker: logtide-worker
SERVICE_NAME=logtide-backend

# Frontend (SvelteKit)
# Public API URL for frontend to connect to backend
#
# When using docker-compose.yml (with Traefik reverse proxy):
#   - Leave empty or don't set - frontend uses relative URLs automatically
#   - This is the recommended production setup
#
# When running frontend separately or in development:
#   - Set to the backend URL (e.g., http://localhost:8080)
#
# PUBLIC_API_URL=http://localhost:8080

# GitHub API Token (optional - for SigmaHQ integration)
# Without token: 60 requests/hour rate limit
# With token: 5000 requests/hour rate limit
# Create token at: https://github.com/settings/tokens (no scopes needed for public repos)
# GITHUB_TOKEN=ghp_your_github_personal_access_token_here

# Docker Images (optional - specify custom images or versions)
# By default, uses latest from Docker Hub
# Available registries:
#   - Docker Hub: logtide/backend:latest, logtide/frontend:latest
#   - GHCR: ghcr.io/logtide-dev/logtide-backend:latest, ghcr.io/logtide-dev/logtide-frontend:latest
# LOGTIDE_BACKEND_IMAGE=logtide/backend:0.4.1
# LOGTIDE_FRONTEND_IMAGE=logtide/frontend:0.4.1

# Fluent Bit image (for log collection with --profile logging)
# Default: fluent/fluent-bit:4.2.2
# For Raspberry Pi / ARM64, you may need to build your own image or use:
#   - cr.fluentbit.io/fluent/fluent-bit:4.2.2 (official multi-arch)
#   - Custom ARM64 build
# FLUENT_BIT_IMAGE=fluent/fluent-bit:4.2.2

# =============================================================================
# INITIAL ADMIN (for first deployment)
# =============================================================================
#
# Create an initial admin user automatically on first startup.
# Only creates the user if NO users with login credentials exist.
# Safe to leave in your deployment configuration - ignored after first user is created.
#
# INITIAL_ADMIN_EMAIL=admin@example.com
# INITIAL_ADMIN_PASSWORD=your-secure-password
# INITIAL_ADMIN_NAME=Administrator

# =============================================================================
# EXTERNAL AUTHENTICATION (OIDC / LDAP)
# =============================================================================
#
# External authentication is configured via the Admin UI at /dashboard/admin/auth-providers
# Alternatively, you can configure a default OIDC or LDAP provider via environment variables.
#
# Note: Environment-based configuration is optional. The Admin UI provides full control
# over authentication providers without requiring environment variables.
#
# --- OpenID Connect (OIDC) ---
# Supports: Authentik, Keycloak, Okta, Auth0, Azure AD, Google, etc.
#
# OIDC_DEFAULT_ISSUER_URL=https://auth.example.com
# OIDC_DEFAULT_CLIENT_ID=your-client-id
# OIDC_DEFAULT_CLIENT_SECRET=your-client-secret
# OIDC_DEFAULT_NAME=Company SSO
#
# --- LDAP / Active Directory ---
#
# LDAP_DEFAULT_URL=ldap://dc.example.com:389
# LDAP_DEFAULT_BIND_DN=CN=Service Account,OU=Users,DC=example,DC=com
# LDAP_DEFAULT_BIND_PASSWORD=service-account-password
# LDAP_DEFAULT_SEARCH_BASE=OU=Users,DC=example,DC=com
# LDAP_DEFAULT_SEARCH_FILTER=(sAMAccountName={{username}})
# LDAP_DEFAULT_NAME=Active Directory

# =============================================================================
# HORIZONTAL SCALING
# =============================================================================
#
# LogTide supports horizontal scaling out of the box. The backend and worker
# are stateless - all state is stored in PostgreSQL and Redis.
#
# For horizontal scaling, use the Traefik overlay:
#   docker compose -f docker-compose.yml -f docker-compose.traefik.yml up -d
#   docker compose -f docker-compose.yml -f docker-compose.traefik.yml up -d --scale backend=3 --scale worker=2
#
# Architecture:
#   - Traefik: Reverse proxy, load balances across backend instances (port 3080)
#   - Backend: Stateless API servers (scale freely)
#   - Worker: BullMQ job processors (scale freely, jobs distributed via Redis)
#   - Redis: Shared state (sessions, cache, job queues, rate limiting)
#   - PostgreSQL: Persistent storage (TimescaleDB)
#
# Rate limiting and sessions are shared across instances via Redis.
# No sticky sessions required - any instance can handle any request.
